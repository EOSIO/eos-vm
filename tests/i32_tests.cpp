#include <algorithm>
#include <vector>
#include <iterator>
#include <cstdlib>
#include <iostream>
#include <math.h>

#include <boost/test/unit_test.hpp>
#include <boost/test/framework.hpp>

#include "utils.hpp"

#include <eosio/wasm_backend/backend.hpp>

using namespace eosio;
using namespace eosio::wasm_backend;

extern wasm_allocator wa;

BOOST_AUTO_TEST_SUITE(i32_spec_tests)

BOOST_AUTO_TEST_CASE(i32_tests) {
   try {
      auto code = backend::read_wasm( "wasms/i32.wasm" );
      backend bkend( code, wa );

      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("add", (uint32_t)1, (uint32_t)1)), (uint32_t)2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("add", (uint32_t)1, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("add", (uint32_t)-1, (uint32_t)-1)), (uint32_t)-2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("add", (uint32_t)-1, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("add", (uint32_t)0x7fffffff, (uint32_t)1)), (uint32_t)0x80000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("add", (uint32_t)0x80000000, (uint32_t)-1)), (uint32_t)0x7fffffff);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("add", (uint32_t)0x80000000, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("add", (uint32_t)0x3fffffff, (uint32_t)1)), (uint32_t)0x40000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("sub", (uint32_t)1, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("sub", (uint32_t)1, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("sub", (uint32_t)-1, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("sub", (uint32_t)0x7fffffff, (uint32_t)-1)), (uint32_t)0x80000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("sub", (uint32_t)0x80000000, (uint32_t)1)), (uint32_t)0x7fffffff);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("sub", (uint32_t)0x80000000, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("sub", (uint32_t)0x3fffffff, (uint32_t)-1)), (uint32_t)0x40000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("mul", (uint32_t)1, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("mul", (uint32_t)1, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("mul", (uint32_t)-1, (uint32_t)-1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("mul", (uint32_t)0x10000000, (uint32_t)4096)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("mul", (uint32_t)0x80000000, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("mul", (uint32_t)0x80000000, (uint32_t)-1)), (uint32_t)0x80000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("mul", (uint32_t)0x7fffffff, (uint32_t)-1)), (uint32_t)0x80000001);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("mul", (uint32_t)0x01234567, (uint32_t)0x76543210)), (uint32_t)0x358e7470);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("mul", (uint32_t)0x7fffffff, (uint32_t)0x7fffffff)), (uint32_t)1);
      BOOST_CHECK_THROW(bkend("div_s", (uint32_t)1, (uint32_t)0), eosio::wasm_backend::wasm_interpreter_exception);
      BOOST_CHECK_THROW(bkend("div_s", (uint32_t)0, (uint32_t)0), eosio::wasm_backend::wasm_interpreter_exception);
      BOOST_CHECK_THROW(bkend("div_s", (uint32_t)0x80000000, (uint32_t)-1), eosio::wasm_backend::wasm_interpreter_exception);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_s", (uint32_t)1, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_s", (uint32_t)0, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_s", (uint32_t)0, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_s", (uint32_t)-1, (uint32_t)-1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_s", (uint32_t)0x80000000, (uint32_t)2)), (uint32_t)0xc0000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_s", (uint32_t)0x80000001, (uint32_t)1000)), (uint32_t)0xffdf3b65);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_s", (uint32_t)5, (uint32_t)2)), (uint32_t)2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_s", (uint32_t)-5, (uint32_t)2)), (uint32_t)-2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_s", (uint32_t)5, (uint32_t)-2)), (uint32_t)-2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_s", (uint32_t)-5, (uint32_t)-2)), (uint32_t)2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_s", (uint32_t)7, (uint32_t)3)), (uint32_t)2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_s", (uint32_t)-7, (uint32_t)3)), (uint32_t)-2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_s", (uint32_t)7, (uint32_t)-3)), (uint32_t)-2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_s", (uint32_t)-7, (uint32_t)-3)), (uint32_t)2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_s", (uint32_t)11, (uint32_t)5)), (uint32_t)2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_s", (uint32_t)17, (uint32_t)7)), (uint32_t)2);
      BOOST_CHECK_THROW(bkend("div_u", (uint32_t)1, (uint32_t)0), eosio::wasm_backend::wasm_interpreter_exception);
      BOOST_CHECK_THROW(bkend("div_u", (uint32_t)0, (uint32_t)0), eosio::wasm_backend::wasm_interpreter_exception);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_u", (uint32_t)1, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_u", (uint32_t)0, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_u", (uint32_t)-1, (uint32_t)-1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_u", (uint32_t)0x80000000, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_u", (uint32_t)0x80000000, (uint32_t)2)), (uint32_t)0x40000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_u", (uint32_t)0x8ff00ff0, (uint32_t)0x10001)), (uint32_t)0x8fef);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_u", (uint32_t)0x80000001, (uint32_t)1000)), (uint32_t)0x20c49b);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_u", (uint32_t)5, (uint32_t)2)), (uint32_t)2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_u", (uint32_t)-5, (uint32_t)2)), (uint32_t)0x7ffffffd);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_u", (uint32_t)5, (uint32_t)-2)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_u", (uint32_t)-5, (uint32_t)-2)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_u", (uint32_t)7, (uint32_t)3)), (uint32_t)2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_u", (uint32_t)11, (uint32_t)5)), (uint32_t)2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("div_u", (uint32_t)17, (uint32_t)7)), (uint32_t)2);
      BOOST_CHECK_THROW(bkend("rem_s", (uint32_t)1, (uint32_t)0), eosio::wasm_backend::wasm_interpreter_exception);
      BOOST_CHECK_THROW(bkend("rem_s", (uint32_t)0, (uint32_t)0), eosio::wasm_backend::wasm_interpreter_exception);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)0x7fffffff, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)1, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)0, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)0, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)-1, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)0x80000000, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)0x80000000, (uint32_t)2)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)0x80000001, (uint32_t)1000)), (uint32_t)-647);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)5, (uint32_t)2)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)-5, (uint32_t)2)), (uint32_t)-1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)5, (uint32_t)-2)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)-5, (uint32_t)-2)), (uint32_t)-1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)7, (uint32_t)3)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)-7, (uint32_t)3)), (uint32_t)-1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)7, (uint32_t)-3)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)-7, (uint32_t)-3)), (uint32_t)-1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)11, (uint32_t)5)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_s", (uint32_t)17, (uint32_t)7)), (uint32_t)3);
      BOOST_CHECK_THROW(bkend("rem_u", (uint32_t)1, (uint32_t)0), eosio::wasm_backend::wasm_interpreter_exception);
      BOOST_CHECK_THROW(bkend("rem_u", (uint32_t)0, (uint32_t)0), eosio::wasm_backend::wasm_interpreter_exception);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_u", (uint32_t)1, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_u", (uint32_t)0, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_u", (uint32_t)-1, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_u", (uint32_t)0x80000000, (uint32_t)-1)), (uint32_t)0x80000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_u", (uint32_t)0x80000000, (uint32_t)2)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_u", (uint32_t)0x8ff00ff0, (uint32_t)0x10001)), (uint32_t)0x8001);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_u", (uint32_t)0x80000001, (uint32_t)1000)), (uint32_t)649);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_u", (uint32_t)5, (uint32_t)2)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_u", (uint32_t)-5, (uint32_t)2)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_u", (uint32_t)5, (uint32_t)-2)), (uint32_t)5);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_u", (uint32_t)-5, (uint32_t)-2)), (uint32_t)-5);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_u", (uint32_t)7, (uint32_t)3)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_u", (uint32_t)11, (uint32_t)5)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rem_u", (uint32_t)17, (uint32_t)7)), (uint32_t)3);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("and", (uint32_t)1, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("and", (uint32_t)0, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("and", (uint32_t)1, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("and", (uint32_t)0, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("and", (uint32_t)0x7fffffff, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("and", (uint32_t)0x7fffffff, (uint32_t)-1)), (uint32_t)0x7fffffff);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("and", (uint32_t)0xf0f0ffff, (uint32_t)0xfffff0f0)), (uint32_t)0xf0f0f0f0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("and", (uint32_t)0xffffffff, (uint32_t)0xffffffff)), (uint32_t)0xffffffff);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("or", (uint32_t)1, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("or", (uint32_t)0, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("or", (uint32_t)1, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("or", (uint32_t)0, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("or", (uint32_t)0x7fffffff, (uint32_t)0x80000000)), (uint32_t)-1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("or", (uint32_t)0x80000000, (uint32_t)0)), (uint32_t)0x80000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("or", (uint32_t)0xf0f0ffff, (uint32_t)0xfffff0f0)), (uint32_t)0xffffffff);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("or", (uint32_t)0xffffffff, (uint32_t)0xffffffff)), (uint32_t)0xffffffff);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("xor", (uint32_t)1, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("xor", (uint32_t)0, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("xor", (uint32_t)1, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("xor", (uint32_t)0, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("xor", (uint32_t)0x7fffffff, (uint32_t)0x80000000)), (uint32_t)-1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("xor", (uint32_t)0x80000000, (uint32_t)0)), (uint32_t)0x80000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("xor", (uint32_t)-1, (uint32_t)0x80000000)), (uint32_t)0x7fffffff);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("xor", (uint32_t)-1, (uint32_t)0x7fffffff)), (uint32_t)0x80000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("xor", (uint32_t)0xf0f0ffff, (uint32_t)0xfffff0f0)), (uint32_t)0x0f0f0f0f);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("xor", (uint32_t)0xffffffff, (uint32_t)0xffffffff)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shl", (uint32_t)1, (uint32_t)1)), (uint32_t)2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shl", (uint32_t)1, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shl", (uint32_t)0x7fffffff, (uint32_t)1)), (uint32_t)0xfffffffe);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shl", (uint32_t)0xffffffff, (uint32_t)1)), (uint32_t)0xfffffffe);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shl", (uint32_t)0x80000000, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shl", (uint32_t)0x40000000, (uint32_t)1)), (uint32_t)0x80000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shl", (uint32_t)1, (uint32_t)31)), (uint32_t)0x80000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shl", (uint32_t)1, (uint32_t)32)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shl", (uint32_t)1, (uint32_t)33)), (uint32_t)2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shl", (uint32_t)1, (uint32_t)-1)), (uint32_t)0x80000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shl", (uint32_t)1, (uint32_t)0x7fffffff)), (uint32_t)0x80000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_s", (uint32_t)1, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_s", (uint32_t)1, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_s", (uint32_t)-1, (uint32_t)1)), (uint32_t)-1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_s", (uint32_t)0x7fffffff, (uint32_t)1)), (uint32_t)0x3fffffff);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_s", (uint32_t)0x80000000, (uint32_t)1)), (uint32_t)0xc0000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_s", (uint32_t)0x40000000, (uint32_t)1)), (uint32_t)0x20000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_s", (uint32_t)1, (uint32_t)32)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_s", (uint32_t)1, (uint32_t)33)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_s", (uint32_t)1, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_s", (uint32_t)1, (uint32_t)0x7fffffff)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_s", (uint32_t)1, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_s", (uint32_t)0x80000000, (uint32_t)31)), (uint32_t)-1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_s", (uint32_t)-1, (uint32_t)32)), (uint32_t)-1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_s", (uint32_t)-1, (uint32_t)33)), (uint32_t)-1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_s", (uint32_t)-1, (uint32_t)-1)), (uint32_t)-1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_s", (uint32_t)-1, (uint32_t)0x7fffffff)), (uint32_t)-1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_s", (uint32_t)-1, (uint32_t)0x80000000)), (uint32_t)-1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_u", (uint32_t)1, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_u", (uint32_t)1, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_u", (uint32_t)-1, (uint32_t)1)), (uint32_t)0x7fffffff);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_u", (uint32_t)0x7fffffff, (uint32_t)1)), (uint32_t)0x3fffffff);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_u", (uint32_t)0x80000000, (uint32_t)1)), (uint32_t)0x40000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_u", (uint32_t)0x40000000, (uint32_t)1)), (uint32_t)0x20000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_u", (uint32_t)1, (uint32_t)32)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_u", (uint32_t)1, (uint32_t)33)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_u", (uint32_t)1, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_u", (uint32_t)1, (uint32_t)0x7fffffff)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_u", (uint32_t)1, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_u", (uint32_t)0x80000000, (uint32_t)31)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_u", (uint32_t)-1, (uint32_t)32)), (uint32_t)-1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_u", (uint32_t)-1, (uint32_t)33)), (uint32_t)0x7fffffff);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_u", (uint32_t)-1, (uint32_t)-1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_u", (uint32_t)-1, (uint32_t)0x7fffffff)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("shr_u", (uint32_t)-1, (uint32_t)0x80000000)), (uint32_t)-1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotl", (uint32_t)1, (uint32_t)1)), (uint32_t)2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotl", (uint32_t)1, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotl", (uint32_t)-1, (uint32_t)1)), (uint32_t)-1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotl", (uint32_t)1, (uint32_t)32)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotl", (uint32_t)0xabcd9876, (uint32_t)1)), (uint32_t)0x579b30ed);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotl", (uint32_t)0xfe00dc00, (uint32_t)4)), (uint32_t)0xe00dc00f);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotl", (uint32_t)0xb0c1d2e3, (uint32_t)5)), (uint32_t)0x183a5c76);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotl", (uint32_t)0x00008000, (uint32_t)37)), (uint32_t)0x00100000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotl", (uint32_t)0xb0c1d2e3, (uint32_t)0xff05)), (uint32_t)0x183a5c76);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotl", (uint32_t)0x769abcdf, (uint32_t)0xffffffed)), (uint32_t)0x579beed3);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotl", (uint32_t)0x769abcdf, (uint32_t)0x8000000d)), (uint32_t)0x579beed3);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotl", (uint32_t)1, (uint32_t)31)), (uint32_t)0x80000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotl", (uint32_t)0x80000000, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotr", (uint32_t)1, (uint32_t)1)), (uint32_t)0x80000000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotr", (uint32_t)1, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotr", (uint32_t)-1, (uint32_t)1)), (uint32_t)-1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotr", (uint32_t)1, (uint32_t)32)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotr", (uint32_t)0xff00cc00, (uint32_t)1)), (uint32_t)0x7f806600);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotr", (uint32_t)0x00080000, (uint32_t)4)), (uint32_t)0x00008000);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotr", (uint32_t)0xb0c1d2e3, (uint32_t)5)), (uint32_t)0x1d860e97);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotr", (uint32_t)0x00008000, (uint32_t)37)), (uint32_t)0x00000400);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotr", (uint32_t)0xb0c1d2e3, (uint32_t)0xff05)), (uint32_t)0x1d860e97);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotr", (uint32_t)0x769abcdf, (uint32_t)0xffffffed)), (uint32_t)0xe6fbb4d5);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotr", (uint32_t)0x769abcdf, (uint32_t)0x8000000d)), (uint32_t)0xe6fbb4d5);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotr", (uint32_t)1, (uint32_t)31)), (uint32_t)2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("rotr", (uint32_t)0x80000000, (uint32_t)31)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("clz", (uint32_t)0xffffffff)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("clz", (uint32_t)0)), (uint32_t)32);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("clz", (uint32_t)0x00008000)), (uint32_t)16);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("clz", (uint32_t)0xff)), (uint32_t)24);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("clz", (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("clz", (uint32_t)1)), (uint32_t)31);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("clz", (uint32_t)2)), (uint32_t)30);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("clz", (uint32_t)0x7fffffff)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ctz", (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ctz", (uint32_t)0)), (uint32_t)32);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ctz", (uint32_t)0x00008000)), (uint32_t)15);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ctz", (uint32_t)0x00010000)), (uint32_t)16);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ctz", (uint32_t)0x80000000)), (uint32_t)31);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ctz", (uint32_t)0x7fffffff)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("popcnt", (uint32_t)-1)), (uint32_t)32);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("popcnt", (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("popcnt", (uint32_t)0x00008000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("popcnt", (uint32_t)0x80008000)), (uint32_t)2);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("popcnt", (uint32_t)0x7fffffff)), (uint32_t)31);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("popcnt", (uint32_t)0xAAAAAAAA)), (uint32_t)16);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("popcnt", (uint32_t)0x55555555)), (uint32_t)16);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("popcnt", (uint32_t)0xDEADBEEF)), (uint32_t)24);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eqz", (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eqz", (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eqz", (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eqz", (uint32_t)0x7fffffff)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eqz", (uint32_t)0xffffffff)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eq", (uint32_t)0, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eq", (uint32_t)1, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eq", (uint32_t)-1, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eq", (uint32_t)0x80000000, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eq", (uint32_t)0x7fffffff, (uint32_t)0x7fffffff)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eq", (uint32_t)-1, (uint32_t)-1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eq", (uint32_t)1, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eq", (uint32_t)0, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eq", (uint32_t)0x80000000, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eq", (uint32_t)0, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eq", (uint32_t)0x80000000, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eq", (uint32_t)-1, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eq", (uint32_t)0x80000000, (uint32_t)0x7fffffff)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("eq", (uint32_t)0x7fffffff, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ne", (uint32_t)0, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ne", (uint32_t)1, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ne", (uint32_t)-1, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ne", (uint32_t)0x80000000, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ne", (uint32_t)0x7fffffff, (uint32_t)0x7fffffff)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ne", (uint32_t)-1, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ne", (uint32_t)1, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ne", (uint32_t)0, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ne", (uint32_t)0x80000000, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ne", (uint32_t)0, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ne", (uint32_t)0x80000000, (uint32_t)-1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ne", (uint32_t)-1, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ne", (uint32_t)0x80000000, (uint32_t)0x7fffffff)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ne", (uint32_t)0x7fffffff, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_s", (uint32_t)0, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_s", (uint32_t)1, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_s", (uint32_t)-1, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_s", (uint32_t)0x80000000, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_s", (uint32_t)0x7fffffff, (uint32_t)0x7fffffff)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_s", (uint32_t)-1, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_s", (uint32_t)1, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_s", (uint32_t)0, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_s", (uint32_t)0x80000000, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_s", (uint32_t)0, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_s", (uint32_t)0x80000000, (uint32_t)-1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_s", (uint32_t)-1, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_s", (uint32_t)0x80000000, (uint32_t)0x7fffffff)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_s", (uint32_t)0x7fffffff, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_u", (uint32_t)0, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_u", (uint32_t)1, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_u", (uint32_t)-1, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_u", (uint32_t)0x80000000, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_u", (uint32_t)0x7fffffff, (uint32_t)0x7fffffff)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_u", (uint32_t)-1, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_u", (uint32_t)1, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_u", (uint32_t)0, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_u", (uint32_t)0x80000000, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_u", (uint32_t)0, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_u", (uint32_t)0x80000000, (uint32_t)-1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_u", (uint32_t)-1, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_u", (uint32_t)0x80000000, (uint32_t)0x7fffffff)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("lt_u", (uint32_t)0x7fffffff, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_s", (uint32_t)0, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_s", (uint32_t)1, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_s", (uint32_t)-1, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_s", (uint32_t)0x80000000, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_s", (uint32_t)0x7fffffff, (uint32_t)0x7fffffff)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_s", (uint32_t)-1, (uint32_t)-1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_s", (uint32_t)1, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_s", (uint32_t)0, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_s", (uint32_t)0x80000000, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_s", (uint32_t)0, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_s", (uint32_t)0x80000000, (uint32_t)-1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_s", (uint32_t)-1, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_s", (uint32_t)0x80000000, (uint32_t)0x7fffffff)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_s", (uint32_t)0x7fffffff, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_u", (uint32_t)0, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_u", (uint32_t)1, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_u", (uint32_t)-1, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_u", (uint32_t)0x80000000, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_u", (uint32_t)0x7fffffff, (uint32_t)0x7fffffff)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_u", (uint32_t)-1, (uint32_t)-1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_u", (uint32_t)1, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_u", (uint32_t)0, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_u", (uint32_t)0x80000000, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_u", (uint32_t)0, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_u", (uint32_t)0x80000000, (uint32_t)-1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_u", (uint32_t)-1, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_u", (uint32_t)0x80000000, (uint32_t)0x7fffffff)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("le_u", (uint32_t)0x7fffffff, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_s", (uint32_t)0, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_s", (uint32_t)1, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_s", (uint32_t)-1, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_s", (uint32_t)0x80000000, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_s", (uint32_t)0x7fffffff, (uint32_t)0x7fffffff)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_s", (uint32_t)-1, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_s", (uint32_t)1, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_s", (uint32_t)0, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_s", (uint32_t)0x80000000, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_s", (uint32_t)0, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_s", (uint32_t)0x80000000, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_s", (uint32_t)-1, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_s", (uint32_t)0x80000000, (uint32_t)0x7fffffff)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_s", (uint32_t)0x7fffffff, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_u", (uint32_t)0, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_u", (uint32_t)1, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_u", (uint32_t)-1, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_u", (uint32_t)0x80000000, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_u", (uint32_t)0x7fffffff, (uint32_t)0x7fffffff)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_u", (uint32_t)-1, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_u", (uint32_t)1, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_u", (uint32_t)0, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_u", (uint32_t)0x80000000, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_u", (uint32_t)0, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_u", (uint32_t)0x80000000, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_u", (uint32_t)-1, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_u", (uint32_t)0x80000000, (uint32_t)0x7fffffff)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("gt_u", (uint32_t)0x7fffffff, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_s", (uint32_t)0, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_s", (uint32_t)1, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_s", (uint32_t)-1, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_s", (uint32_t)0x80000000, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_s", (uint32_t)0x7fffffff, (uint32_t)0x7fffffff)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_s", (uint32_t)-1, (uint32_t)-1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_s", (uint32_t)1, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_s", (uint32_t)0, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_s", (uint32_t)0x80000000, (uint32_t)0)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_s", (uint32_t)0, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_s", (uint32_t)0x80000000, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_s", (uint32_t)-1, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_s", (uint32_t)0x80000000, (uint32_t)0x7fffffff)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_s", (uint32_t)0x7fffffff, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_u", (uint32_t)0, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_u", (uint32_t)1, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_u", (uint32_t)-1, (uint32_t)1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_u", (uint32_t)0x80000000, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_u", (uint32_t)0x7fffffff, (uint32_t)0x7fffffff)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_u", (uint32_t)-1, (uint32_t)-1)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_u", (uint32_t)1, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_u", (uint32_t)0, (uint32_t)1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_u", (uint32_t)0x80000000, (uint32_t)0)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_u", (uint32_t)0, (uint32_t)0x80000000)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_u", (uint32_t)0x80000000, (uint32_t)-1)), (uint32_t)0);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_u", (uint32_t)-1, (uint32_t)0x80000000)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_u", (uint32_t)0x80000000, (uint32_t)0x7fffffff)), (uint32_t)1);
      BOOST_CHECK_EQUAL(TO_UINT32(*bkend("ge_u", (uint32_t)0x7fffffff, (uint32_t)0x80000000)), (uint32_t)0);
   } FC_LOG_AND_RETHROW()
}

BOOST_AUTO_TEST_SUITE_END()
